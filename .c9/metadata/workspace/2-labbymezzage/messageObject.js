{"filter":false,"title":"messageObject.js","tooltip":"/2-labbymezzage/messageObject.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":19,"column":8},"end":{"row":19,"column":9},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":9},"end":{"row":19,"column":10},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":10},"end":{"row":19,"column":11},"action":"insert","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":11},"end":{"row":19,"column":12},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":12},"end":{"row":19,"column":13},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":13},"end":{"row":19,"column":14},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":14},"end":{"row":19,"column":15},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":15},"end":{"row":19,"column":16},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":16},"end":{"row":19,"column":17},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":15},"end":{"row":19,"column":17},"action":"remove","lines":["on"]},{"start":{"row":19,"column":15},"end":{"row":19,"column":22},"action":"insert","lines":["onclick"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":13},"end":{"row":19,"column":14},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":12},"end":{"row":19,"column":13},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":11},"end":{"row":19,"column":12},"action":"remove","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":10},"end":{"row":19,"column":11},"action":"remove","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":9},"end":{"row":19,"column":10},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":8},"end":{"row":19,"column":9},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":8},"end":{"row":19,"column":9},"action":"insert","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":9},"end":{"row":19,"column":10},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":10},"end":{"row":19,"column":11},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":8},"end":{"row":19,"column":11},"action":"remove","lines":["but"]},{"start":{"row":19,"column":8},"end":{"row":19,"column":18},"action":"insert","lines":["buttonPost"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":26},"end":{"row":20,"column":8},"action":"remove","lines":["","        "]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":25},"end":{"row":19,"column":26},"action":"remove","lines":["k"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":24},"end":{"row":19,"column":25},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":23},"end":{"row":19,"column":24},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":22},"end":{"row":19,"column":23},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":21},"end":{"row":19,"column":22},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":20},"end":{"row":19,"column":21},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":19},"end":{"row":19,"column":20},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":18},"end":{"row":19,"column":19},"action":"remove","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":17},"end":{"row":19,"column":18},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":16},"end":{"row":19,"column":17},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":15},"end":{"row":19,"column":16},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":14},"end":{"row":19,"column":15},"action":"remove","lines":["P"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":13},"end":{"row":19,"column":14},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":12},"end":{"row":19,"column":13},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":11},"end":{"row":19,"column":12},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":10},"end":{"row":19,"column":11},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":9},"end":{"row":19,"column":10},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":8},"end":{"row":19,"column":9},"action":"remove","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":8},"end":{"row":8,"column":54},"action":"remove","lines":["buttonPost.onclick = labbyMezzage.postMessage;"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":8},"end":{"row":19,"column":54},"action":"insert","lines":["buttonPost.onclick = labbyMezzage.postMessage;"]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":4},"end":{"row":106,"column":8},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":4},"end":{"row":106,"column":5},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":5},"end":{"row":106,"column":6},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":6},"end":{"row":106,"column":7},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":105,"column":7},"end":{"row":105,"column":8},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":7},"end":{"row":106,"column":8},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":107,"column":2},"end":{"row":107,"column":3},"action":"remove","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":108,"column":8},"end":{"row":108,"column":12},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":109,"column":16},"end":{"row":109,"column":17},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":109,"column":12},"end":{"row":109,"column":16},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":109,"column":8},"end":{"row":109,"column":12},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":17},"end":{"row":110,"column":18},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":16},"end":{"row":110,"column":17},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":12},"end":{"row":110,"column":16},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":110,"column":8},"end":{"row":110,"column":12},"action":"remove","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":138,"column":34},"action":"remove","lines":["\"use strict\";","console.log(\"labbyMezzage loaded\");","","var labbyMezzage = {","","    init: function () ","    {","        var buttonPost = document.getElementById(\"button\");","        ","        ","        var entersend = document.getElementById(\"messageInput\");","        entersend.onkeypress=function(e){if (e.keyCode == 13 && !e.shiftKey && document.getElementById(\"messageInput\").value !== \"\"){","                e.preventDefault();","                labbyMezzage.postMessage();","                }","                if (e.keyCode == 13 && document.getElementById(\"messageInput\").value === \"\")","                {e.preventDefault()}","                ","        };","        buttonPost.onclick = labbyMezzage.postMessage;","    },","","    postMessage: function ()","    {","        createMessageObjekt();","        renderLatestMessage();","","        function createMessageObjekt()","        {","            ","            var textarea = document.getElementById(\"messageInput\");","            labbyMezzage.messages.push( new Message( textarea.value, new Date()));","","        }","        ","    ","        function renderLatestMessage()","        {","            ","\t\tvar post = document.createElement(\"div\");","\t\t","\t\tvar postFunction = document.createElement(\"div\");","\t","\t\tvar imgTime = document.createElement(\"a\");","\t\tvar aTime = document.createElement(\"a\");","\t","\t","\t\t","\t\t","\t\tpost.setAttribute(\"class\", \"post\");","\t\tpostFunction.setAttribute(\"class\", \"postFunction\");","\t","\t","\t\timgTime.setAttribute(\"src\", \"pics/clock.png\");","\t\timgTime.setAttribute(\"alt\", \"a klock\");","\t","\t\taTime.setAttribute(\"href\", \"#\");","\t","\t\t","\t\t","\t\t","            var lastMessageId = labbyMezzage.messages.length - 1;","","            var messageBoard = document.getElementById(\"messageBoard\");","","            var message = document.createElement(\"article\");","            message.setAttribute(\"class\", \"message\");","            var time = document.createElement(\"time\");","            var p = document.createElement(\"p\");","","            // Skapa ta-bort knapp på meddelandet","            var buttonRemove = document.createElement(\"a\");","            buttonRemove.setAttribute(\"href\", \"#\");","            buttonRemove.innerHTML = '<img src=\"delete.png\" width=\"24px\" height=\"24px\" />';","            buttonRemove.addEventListener(\"click\", labbyMezzage.removeMessage, false);","            message.appendChild(buttonRemove);","","        ","//Time and date image","\t\t   ","\t     \taTime.appendChild(imgTime);","            message.appendChild(time);","            ","\t\taTime.onclick = function(e){","\t\t   var imgTime = document.createElement(\"a\");","\t\t   imgTime.setAttribute(\"src\", \"clock.png\");","\t\t\te.preventDefault();","\t\t\tlabbyMezzage.showTime(lastMessageId);","\t\t\talert(labbyMezzage.messages[lastMessageId].toString());","\t\t},","","            ","            time.setAttribute(\"datetime\", labbyMezzage.messages[lastMessageId].getDateStringUTC());","","            time.innerHTML = labbyMezzage.messages[lastMessageId].getClockStringLocal();","            p.innerHTML = labbyMezzage.messages[lastMessageId].getText();","","            ","            message.appendChild(p);","            messageBoard.appendChild(message);","        }","    },","","    removeMessage: function(lastMessageId)","    {","        var messageBoard = document.getElementById(\"messageBoard\");","        var messageClicked = this.parentNode;","\t\tvar result = confirm(\"Är du säker på att du vill radera detta meddelande\");","        if (result===true) {","        var messageNumber = labbyMezzage.getMessageNumber(messageClicked);","        messageBoard.removeChild(messageBoard.childNodes[messageNumber]);","            }","    },","    ","   ","","    getMessageNumber: function(messageClicked)","    {","        var message = document.querySelector(\".message\");","        var count = 0;","","        while (message)","        {","            if (message == messageClicked)","            {","                return count;","            }","","            count++;","            message = message.nextElementSibling;","        }","    }, ","","    messages: []","};","","   ","","window.onload = labbyMezzage.init;"]},{"start":{"row":0,"column":0},"end":{"row":139,"column":36},"action":"insert","lines":["var messageApp = {","    ","    messages: [],","    ","    click: function() {","    \t","    \tvar messageArea = document.getElementById(\"message-area\");","    \t","    \t//Byter ut radbrytningar mot <br> mha getHTMLText","    \tvar fixedMessage = messageApp.getHTMLText(messageArea.value);","    \t","\t\t//Instansierar nytt Message-objekt","\t\tvar mess = new Message(fixedMessage, new Date());","","\t\t//Lägger till meddelandet till arrayen messages","\t\tmessageApp.messages.push(mess);","\t\t","\t\tmessageApp.updateMessCounter();","    \t","    },","    ","    renderMessages: function(){","    \t","    \t//Rensar först div","\t\tvar div = document.getElementById(\"writeout\");","     \tdiv.innerHTML = \"\";","    \t","    \t//Uppdaterar HTML med antal meddelanden","\t\tvar numberMessages = messageApp.messages.length;","\t\t//Loopar igenom arrayen och skriver ut samtliga meddelanden","    \t//mha renderMessage","    \tvar i;","    \t","\t\tfor (i=0; i < numberMessages; i++) {","\t\t\tmessageApp.renderMessage(i);","    \t}","    \t","    },","","\trenderMessage: function(messageID) {","\t\tvar numberMessages = messageApp.messages.length;","\t\t","\t\tif (messageID === undefined) {","\t\t\tmessageID = numberMessages - 1;","\t\t}","\t\t","\t\t//Skapar en paragraf som innehåller meddelandet","\t\tvar text = document.createElement(\"p\");","\t\tvar messageDate = messageApp.messages[messageID].getMessDate();","\t\ttext.innerHTML = messageApp.messages[messageID].getText() + \"<br>\" + messageDate.getHours() + \":\" + messageDate.getMinutes() + \":\" + messageDate.getSeconds() + \" \";","\t\t","\t\t//Skapa en behållare till bildlänkar för borttagning av meddelande och aktuell tid","\t\tvar textHolder = document.createElement(\"div\");","\t\ttextHolder.setAttribute('class','change-message');","\t\t","\t\t//Skapar en bildlänk för att ta bort meddelandet","\t\tvar text2 = document.createElement(\"a\");","\t\ttext2.setAttribute('href', \"#\");","\t\tvar onClickAttr = \"messageApp.removeMessage(\" + messageID + \")\";","\t\ttext2.setAttribute('onclick', onClickAttr);","\t\tvar imgRemove = document.createElement(\"img\");","\t\timgRemove.setAttribute('src','bilder/ta-bort.png');","\t\ttext2.appendChild(imgRemove);","\t\ttextHolder.appendChild(text2);","\t\t","\t\t","\t\tvar messageWriteOut = document.getElementById(\"writeout\");","\t\tmessageWriteOut.appendChild(text);","\t\t","\t\t//Skapar en bildlänk för att visa aktuell tid","\t\tvar timeText = document.createElement(\"a\");","\t\ttimeText.setAttribute('href', \"#\");","\t\tvar onClickAttr2 = \"messageApp.showTime(\" + messageID + \")\";","\t\ttimeText.setAttribute('onclick',onClickAttr2);","\t\tvar imgShowTime = document.createElement(\"img\");","\t\timgShowTime.setAttribute('src','bilder/visa-tid.png');","\t\ttimeText.appendChild(imgShowTime);","\t\ttextHolder.appendChild(timeText);","\t\t","\t\t","\t\t//Lägg till bildlänkarna till behållaren","\t\ttext.appendChild(textHolder);","\t\t","\t\t","\t\treturn false;","\t},","\t","\tremoveMessage: function(messageID) {","\t\t//Kollar om användaren verkligen vill ta bort meddelandet","\t\tif (window.confirm(\"Vill du verkligen ta bort meddelandet?\")) { ","\t\t\t//Tar bort meddelandet ur arrayen messages","\t\t\tvar removed = messageApp.messages.splice(messageID, 1);","\t\t","\t\t\tmessageApp.renderMessages();","\t\t\tmessageApp.updateMessCounter();","\t\t}","\t\t","\t},","\t","\tupdateMessCounter: function() {","\t\t//Uppdaterar HTML med antal meddelanden","\t\tvar numberMessages = messageApp.messages.length;","","\t\tvar numberMessagesHTML = document.getElementById(\"number-messages\");","\t\t","\t\tnumberMessagesHTML.innerHTML = numberMessages;","\t\t","\t\tmessageApp.renderMessages();","\t},","\t","\tshowTime: function(messageID) {","\t\tvar alertDate = messageApp.messages[messageID].getMessDate();","\t\tvar options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };","\t\tvar alertMessage = \"Inlägget skapades \" + alertDate.toLocaleDateString('sv-SV', options) + \" klockan \" + alertDate.getHours() + \":\" + alertDate.getMinutes() + \":\" + alertDate.getSeconds();","\t\t//Visar aktuell tid","\t\talert(alertMessage);","\t},","\t","\tkeyPress: function(e) {","\t\t","\t\t//Kollar så att användaren inte håller ner SHIFT","\t\t//och att användaren trycker på Enter","\t\tif ((!e.shiftKey) && e.keyCode == 13) {","\t\t\t//Användaren har tryckt på enter, skapa messageobjekt och kör renderMessages","\t\t\tmessageApp.click();","\t\t\tmessageApp.renderMessages();","\t\t\tmessageApp.updateMessCounter();","\t\t}","","\t},","\t","\tgetHTMLText: function(message) {","\t\treturn message.replace(/[\\n\\r]/g, \"<br>\");","\t}","","","}","","// Starta applikationen när fönstret laddat klart","//window.onload = messageApp.init;  "]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":0,"column":2},"action":"insert","lines":["\"\""]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":3},"end":{"row":0,"column":4},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":4},"end":{"row":0,"column":5},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":5},"end":{"row":0,"column":6},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":6},"end":{"row":0,"column":7},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":7},"end":{"row":0,"column":8},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":8},"end":{"row":0,"column":9},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":9},"end":{"row":0,"column":10},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":10},"end":{"row":0,"column":11},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":12},"end":{"row":0,"column":13},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":141,"column":1},"end":{"row":141,"column":2},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":141,"column":0},"end":{"row":141,"column":1},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":138,"column":1},"end":{"row":138,"column":2},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":45},"end":{"row":63,"column":46},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":44},"end":{"row":63,"column":45},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":43},"end":{"row":63,"column":44},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":42},"end":{"row":63,"column":43},"action":"remove","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":41},"end":{"row":63,"column":42},"action":"remove","lines":["-"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":40},"end":{"row":63,"column":41},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":39},"end":{"row":63,"column":40},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":38},"end":{"row":63,"column":39},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":37},"end":{"row":63,"column":38},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":36},"end":{"row":63,"column":37},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":35},"end":{"row":63,"column":36},"action":"remove","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":34},"end":{"row":63,"column":35},"action":"remove","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":33},"end":{"row":63,"column":34},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":32},"end":{"row":63,"column":33},"action":"remove","lines":["b"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":32},"end":{"row":63,"column":33},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":33},"end":{"row":63,"column":34},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":34},"end":{"row":63,"column":35},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":35},"end":{"row":63,"column":36},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":36},"end":{"row":63,"column":37},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":37},"end":{"row":63,"column":38},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":34},"end":{"row":77,"column":49},"action":"remove","lines":["bilder/visa-tid"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":34},"end":{"row":77,"column":35},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":35},"end":{"row":77,"column":36},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":36},"end":{"row":77,"column":37},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":37},"end":{"row":77,"column":38},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":38},"end":{"row":77,"column":39},"action":"insert","lines":["k"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":141,"column":34},"action":"remove","lines":["\"use strict\";","","var messageApp = {","    ","    messages: [],","    ","    click: function() {","    \t","    \tvar messageArea = document.getElementById(\"message-area\");","    \t","    \t//Byter ut radbrytningar mot <br> mha getHTMLText","    \tvar fixedMessage = messageApp.getHTMLText(messageArea.value);","    \t","\t\t//Instansierar nytt Message-objekt","\t\tvar mess = new Message(fixedMessage, new Date());","","\t\t//Lägger till meddelandet till arrayen messages","\t\tmessageApp.messages.push(mess);","\t\t","\t\tmessageApp.updateMessCounter();","    \t","    },","    ","    renderMessages: function(){","    \t","    \t//Rensar först div","\t\tvar div = document.getElementById(\"writeout\");","     \tdiv.innerHTML = \"\";","    \t","    \t//Uppdaterar HTML med antal meddelanden","\t\tvar numberMessages = messageApp.messages.length;","\t\t//Loopar igenom arrayen och skriver ut samtliga meddelanden","    \t//mha renderMessage","    \tvar i;","    \t","\t\tfor (i=0; i < numberMessages; i++) {","\t\t\tmessageApp.renderMessage(i);","    \t}","    \t","    },","","\trenderMessage: function(messageID) {","\t\tvar numberMessages = messageApp.messages.length;","\t\t","\t\tif (messageID === undefined) {","\t\t\tmessageID = numberMessages - 1;","\t\t}","\t\t","\t\t//Skapar en paragraf som innehåller meddelandet","\t\tvar text = document.createElement(\"p\");","\t\tvar messageDate = messageApp.messages[messageID].getMessDate();","\t\ttext.innerHTML = messageApp.messages[messageID].getText() + \"<br>\" + messageDate.getHours() + \":\" + messageDate.getMinutes() + \":\" + messageDate.getSeconds() + \" \";","\t\t","\t\t//Skapa en behållare till bildlänkar för borttagning av meddelande och aktuell tid","\t\tvar textHolder = document.createElement(\"div\");","\t\ttextHolder.setAttribute('class','change-message');","\t\t","\t\t//Skapar en bildlänk för att ta bort meddelandet","\t\tvar text2 = document.createElement(\"a\");","\t\ttext2.setAttribute('href', \"#\");","\t\tvar onClickAttr = \"messageApp.removeMessage(\" + messageID + \")\";","\t\ttext2.setAttribute('onclick', onClickAttr);","\t\tvar imgRemove = document.createElement(\"img\");","\t\timgRemove.setAttribute('src','delete.png');","\t\ttext2.appendChild(imgRemove);","\t\ttextHolder.appendChild(text2);","\t\t","\t\t","\t\tvar messageWriteOut = document.getElementById(\"writeout\");","\t\tmessageWriteOut.appendChild(text);","\t\t","\t\t//Skapar en bildlänk för att visa aktuell tid","\t\tvar timeText = document.createElement(\"a\");","\t\ttimeText.setAttribute('href', \"#\");","\t\tvar onClickAttr2 = \"messageApp.showTime(\" + messageID + \")\";","\t\ttimeText.setAttribute('onclick',onClickAttr2);","\t\tvar imgShowTime = document.createElement(\"img\");","\t\timgShowTime.setAttribute('src','clock.png');","\t\ttimeText.appendChild(imgShowTime);","\t\ttextHolder.appendChild(timeText);","\t\t","\t\t","\t\t//Lägg till bildlänkarna till behållaren","\t\ttext.appendChild(textHolder);","\t\t","\t\t","\t\treturn false;","\t},","\t","\tremoveMessage: function(messageID) {","\t\t//Kollar om användaren verkligen vill ta bort meddelandet","\t\tif (window.confirm(\"Vill du verkligen ta bort meddelandet?\")) { ","\t\t\t//Tar bort meddelandet ur arrayen messages","\t\t\tvar removed = messageApp.messages.splice(messageID, 1);","\t\t","\t\t\tmessageApp.renderMessages();","\t\t\tmessageApp.updateMessCounter();","\t\t}","\t\t","\t},","\t","\tupdateMessCounter: function() {","\t\t//Uppdaterar HTML med antal meddelanden","\t\tvar numberMessages = messageApp.messages.length;","","\t\tvar numberMessagesHTML = document.getElementById(\"number-messages\");","\t\t","\t\tnumberMessagesHTML.innerHTML = numberMessages;","\t\t","\t\tmessageApp.renderMessages();","\t},","\t","\tshowTime: function(messageID) {","\t\tvar alertDate = messageApp.messages[messageID].getMessDate();","\t\tvar options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };","\t\tvar alertMessage = \"Inlägget skapades \" + alertDate.toLocaleDateString('sv-SV', options) + \" klockan \" + alertDate.getHours() + \":\" + alertDate.getMinutes() + \":\" + alertDate.getSeconds();","\t\t//Visar aktuell tid","\t\talert(alertMessage);","\t},","\t","\tkeyPress: function(e) {","\t\t","\t\t//Kollar så att användaren inte håller ner SHIFT","\t\t//och att användaren trycker på Enter","\t\tif ((!e.shiftKey) && e.keyCode == 13) {","\t\t\t//Användaren har tryckt på enter, skapa messageobjekt och kör renderMessages","\t\t\tmessageApp.click();","\t\t\tmessageApp.renderMessages();","\t\t\tmessageApp.updateMessCounter();","\t\t}","","\t},","\t","\tgetHTMLText: function(message) {","\t\treturn message.replace(/[\\n\\r]/g, \"<br>\");","\t}","","","};","","// Starta applikationen när fönstret laddat klart","window.onload = messageApp.init;  "]},{"start":{"row":0,"column":0},"end":{"row":192,"column":1},"action":"insert","lines":["window.onload = function() {","\tvar newMessageBoard = document.querySelector(\".newMessageBoard\");","\tvar counterMessageBoard = 0;","","\tnewMessageBoard.onclick = function() {","\t\tvar wrapper = document.querySelector(\".wrapper\");","\t\tvar newBoard = document.createElement(\"div\");","\t\tnewBoard.setAttribute(\"id\", \"board\" +counterMessageBoard);","\t\twrapper.appendChild(newBoard);","","\t\tvar board = new MessageBoard(\"board\" +counterMessageBoard);","\t\tboard.init();","","\t\tcounterMessageBoard += 1;","\t\tconsole.log(counterMessageBoard);","\t\treturn false;","\t};","};","","function MessageBoard(boardID) {","\tvar that = this;","","\tthis.messages = [];","","\tthis.init  = function() {","\t\tvar wrapper = document.querySelector(\".wrapper\");","","\t\tvar board = document.getElementById(boardID);","\t\tvar closeBoard = document.createElement(\"a\");","\t\tvar header = document.createElement(\"header\");","\t\tvar h1 = document.createElement(\"h1\");","\t\tvar messageBox = document.createElement(\"div\");","\t\tvar spanMessageCount = document.createElement(\"span\");","\t\tvar textarea = document.createElement(\"textarea\");","\t\tvar run = document.createElement(\"input\");","\t\tvar changeButton = document.createElement(\"input\");","","","\t\t// Sätt attribut","\t\tcloseBoard.setAttribute(\"href\", \"#\");","\t\tcloseBoard.setAttribute(\"class\", \"closeBoard\");","\t\tcloseBoard.textContent = \"Stäng\";","","\t\theader.setAttribute(\"class\", \"header\");","\t\tmessageBox.setAttribute(\"class\", \"message-box\");","\t\tspanMessageCount.setAttribute(\"class\", \"message-count\");","\t\ttextarea.setAttribute(\"autofocus\", \"autofocus\");","\t\trun.setAttribute(\"class\", \"button send\");","\t\trun.setAttribute(\"type\", \"submit\");","\t\trun.setAttribute(\"value\", \"Skicka\");","\t\tchangeButton.setAttribute(\"type\", \"submit\");","\t\tchangeButton.setAttribute(\"value\", \"Change\");","\t\tchangeButton.setAttribute(\"class\", \"button change\");","","\t\t// Append","\t\theader.appendChild(closeBoard);","\t\tboard.appendChild(header);","\t\theader.appendChild(h1);","\t\th1.textContent = \"LabbyMezzage\";","\t\tboard.appendChild(messageBox);","\t\tboard.appendChild(spanMessageCount);","\t\tboard.appendChild(textarea);","\t\tboard.appendChild(run);","\t\tboard.appendChild(changeButton);","","\t\trun.addEventListener(\"click\", that.newMessage, false);","","\t\t// Stäng messageBoard","\t\tcloseBoard.onclick = function() {","\t\t\twrapper.removeChild(board);","\t\t\treturn false;","\t\t};","","\t\t// Lyssnar till enter","\t\ttextarea.onkeydown = function(e) {","\t\t\tif (!e) { e = window.event; }","\t\t\tif (e.keyCode === 13 && e.shiftKey === false) {","\t\t\t\tthat.newMessage();","\t\t\t\treturn false;","\t\t\t}","\t\t};","\t};","","\tthis.newMessage = function() {","\t\tvar text = document.querySelector(\"#\" +boardID+ \" textarea\");","","\t\tvar messObj = new Message(text.value, new Date());","\t\tthat.messages.push(messObj);","\t\tthat.renderMessages();","","\t\t// Rensar textrutan på text","\t\ttext.value = \"\";","\t};","","\tthis.renderMessages = function() {","\t\tvar messageArea = document.querySelector(\"#\" +boardID+ \" .message-box\");","\t\t// Tar bort alla meddelanden","\t\tmessageArea.innerHTML = \"\";","","\t\t// Sätter antal meddelanden","\t\tvar messageCounter = document.querySelector(\"#\" +boardID+ \" .message-count\");","","\t\tmessageCounter.innerHTML = \"Antal meddelanden: \" + this.messages.length;","","\t\tfor (var i = 0; i < this.messages.length; i += 1) {","\t\t\trenderMessage(i);","\t\t}","","\t\t\tfunction renderMessage(messageID) {","","\t\t\t\tvar text = document.createElement(\"p\");","\t\t\t\tvar messageContainer = document.createElement(\"article\");","\t\t\t\tvar infoContainer = document.createElement(\"div\");","\t\t\t\tvar deleteButton = document.createElement(\"a\");","\t\t\t\tvar timeButton = document.createElement(\"a\");","\t\t\t\tvar timeStamp = document.createElement(\"span\");","\t\t\t\tvar makeChange = document.createElement(\"a\");","","\t\t\t\tinfoContainer.setAttribute(\"class\", \"info\");","\t\t\t\tdeleteButton.setAttribute(\"href\", \"#\");","\t\t\t\tdeleteButton.setAttribute(\"class\", \"delete\");","\t\t\t\ttimeButton.setAttribute(\"href\", \"#\");","\t\t\t\ttimeButton.setAttribute(\"class\", \"time\");","\t\t\t\tmessageContainer.setAttribute(\"class\", \"message\");","\t\t\t\ttimeStamp.setAttribute(\"class\", \"time-stamp\");","\t\t\t\tmakeChange.setAttribute(\"href\", \"#\");","\t\t\t\tmakeChange.setAttribute(\"class\", \"changeMessage\");","\t\t\t\tmakeChange.innerHTML = \"(Edit message)\";","","\t\t\t\t// Lägger till meddelandet","\t\t\t\ttext.innerHTML = that.messages[messageID].getHTMLText();","","\t\t\t\t// Sätter tidstämpel formaterad till timmar, minuter och sekunder","\t\t\t\ttimeStamp.innerHTML = that.messages[messageID].getDateText();","","\t\t\t\tmessageArea.appendChild(messageContainer);","\t\t\t\tmessageContainer.appendChild(text);","\t\t\t\tmessageContainer.appendChild(infoContainer);","\t\t\t\tinfoContainer.appendChild(timeButton);","\t\t\t\tinfoContainer.appendChild(deleteButton);","\t\t\t\tmessageContainer.appendChild(timeStamp);","\t\t\t\tmessageContainer.appendChild(makeChange);","","\t\t\t\t// Ta bort meddelande","\t\t\t\tdeleteButton.onclick = function() {","\t\t\t\t\tvar textbox = document.querySelector(\"#\" +boardID+ \" textarea\");","\t\t\t\t\tif (window.confirm(\"Vill du verkligen radera meddelandet?\")) {","\t\t\t\t\t\tthat.removeMessage(messageID);","\t\t\t\t\t\tmessageArea.innerHTML = \"\";","\t\t\t\t\t\tthat.renderMessages();","\t\t\t\t\t\ttextbox.focus();","\t\t\t\t\t}","","\t\t\t\t\treturn false;","\t\t\t\t};","","\t\t\t\t// Visa tid i alert","\t\t\t\ttimeButton.onclick = function() {","\t\t\t\t\tthat.alertTime(messageID);","\t\t\t\t\treturn false;","\t\t\t\t};","","\t\t\t\t// Redigera meddelande","\t\t\t\tmakeChange.onclick = function() {","\t\t\t\t\tthat.editMessage(messageID);","\t\t\t\t\treturn false;","\t\t\t\t};","\t\t}","","\t};","","\tthis.removeMessage = function(messageID) {","\t\tthis.messages.splice(messageID, 1);","\t};","","\tthis.alertTime = function(messageID) {","\t\talert(this.messages[messageID].getDateText(true));","\t};","","\tthis.editMessage = function(messageID) {","\t\tvar changeButton = document.querySelector(\"#\" +boardID+ \" .change\");","\t\tvar textbox = document.querySelector(\"#\" +boardID+ \" textarea\");","\t\ttextbox.value = this.messages[messageID].getHTMLText();","\t\ttextbox.select();","","\t\tchangeButton.onclick = function() {","\t\t\tthat.messages[messageID].setText(textbox.value);","\t\t\ttextbox.value = \"\";","\t\t\tthat.renderMessages();","\t\t\treturn false;","\t\t};","\t};","}"]}]}]]},"ace":{"folds":[],"scrolltop":1999,"scrollleft":0,"selection":{"start":{"row":192,"column":1},"end":{"row":192,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":141,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1418220839920,"hash":"cccacb92489c0bc9d3b4486386dad56790c5b6d6"}